webpackJsonp([7],{o9cx:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),i=a.n(s),n={name:"Profile",data:function(){return{username:"",reports:0,machines_count:0,email:"",search:"",loading:!0,dialog:!1,headers:[{text:"Alias",align:"center",value:"alias"},{text:"Description",align:"center",value:"description"},{text:"Type",align:"center",value:"system"},{text:"Approved",align:"center",value:"approved"},{text:"Runs",align:"center",value:"count"},{text:"Latest",align:"center",value:"latest"},{text:"Add date",align:"center",value:"addDate"},{text:"Actions",align:"center",value:"actions",sortable:!1}],machines:[],editedMachine:{description:""},new_machine:{alias:"",description:""}}},watch:{dialog:function(t){t||this.close()}},methods:{getCookie:function(t){var e=("; "+document.cookie).split("; "+t+"=");if(2===e.length)return e.pop().split(";").shift()},getProfile:function(){var t=this,e=this.$store.state.endpoints.user,a=new XMLHttpRequest;a.open("GET",e),a.withCredentials=!0,a.setRequestHeader("Content-Type","application/json"),a.send(),a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE){if(200===a.status){var e=JSON.parse(a.response);t.username=e.results[0].username,t.$store.commit("setUsername",e.results[0].username),t.email=e.results[0].email,t.machines_count=e.results[0].machines.length;for(var s=0;s<t.machines_count;s++){var i={alias:e.results[0].machines[s].alias,description:e.results[0].machines[s].description,count:e.results[0].machines[s].count,id:e.results[0].machines[s].machine_id,type:e.results[0].machines[s].machine_type,approved:e.results[0].machines[s].approved,latest:e.results[0].machines[s].latest.run_id,addDate:e.results[0].machines[s].add_time.substring(0,10),secret:e.results[0].machines[s].machine_secret};t.machines.push(i),t.reports+=e.results[0].machines[s].count}t.loading=!1}}else console.log(a.status)}},editMachine:function(t){this.editedIndex=t.id,this.editedMachine.description=t.description,this.dialog=!0},viewSecret:function(t){window.alert("Machine secret: "+t.secret)},close:function(){this.dialog=!1,setTimeout(function(){},300)},save:function(){var t=this,e=this.$store.state.endpoints.edit+this.editedIndex+"/",a=this.getCookie("csrftoken"),s=new XMLHttpRequest;s.open("PUT",e),s.withCredentials=!0,s.setRequestHeader("X-CSRFTOKEN",a),s.setRequestHeader("Content-Type","application/json"),s.send(i()({description:this.editedMachine.description})),s.onreadystatechange=function(){s.readyState===XMLHttpRequest.DONE?200===s.status&&(window.alert("Information changed successfully!"),location.reload()):(console.log(s.status),t.close())}},addMachine:function(){var t=this,e=this.$store.state.endpoints.add,a=this.getCookie("csrftoken"),s=new XMLHttpRequest;s.open("POST",e),s.withCredentials=!0,s.setRequestHeader("X-CSRFTOKEN",a),s.setRequestHeader("Content-Type","application/json"),s.send(i()(this.new_machine)),s.onreadystatechange=function(){s.readyState===XMLHttpRequest.DONE?201===s.status&&(window.alert("Machine added successfully!"),location.reload()):(console.log(s.status),t.close())}}},mounted:function(){null==this.getCookie("csrftoken")?this.$router.push("/"):this.getProfile()},computed:{binding:function(){var t={};return this.$vuetify.breakpoint.mdAndUp&&(t.column=!0),t}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{"d-flex":"",xs12:"",sm6:"",md3:""}},[a("v-layout",{attrs:{column:""}},[a("v-flex",{attrs:{"d-flex":"",md5:""}},[a("v-layout",{attrs:{column:""}},[a("v-card",{staticClass:"profile-left-top",attrs:{flat:"","min-witdh":"15"}},[a("v-card-title",[a("v-icon",{attrs:{color:"white"}},[t._v("person")]),t._v("Your information")],1)],1),t._v(" "),a("v-card",{staticClass:"profile-left-bottom",attrs:{flat:"","min-witdh":"15"}},[a("v-card-text",{staticClass:"profile-left-text"},[a("v-icon",{attrs:{color:"rgb(51, 103, 145)"}},[t._v("email")]),t._v(" "+t._s(t.email)+" "),a("br"),t._v(" "),a("v-icon",{attrs:{color:"rgb(51, 103, 145)"}},[t._v("archive")]),t._v(" Total reports: "+t._s(t.reports)+" "),a("br"),t._v(" "),a("v-icon",{attrs:{color:"rgb(51, 103, 145)"}},[t._v("computer")]),t._v(" N. machine(s): "+t._s(t.machines_count)+" "),a("br")],1)],1)],1)],1),t._v(" "),a("v-flex",{attrs:{"d-flex":"",md5:""}},[a("v-layout",{attrs:{column:""}},[a("v-card",{staticClass:"profile-left-top",attrs:{flat:"","min-witdh":"15"}},[a("v-card-title",[a("v-icon",{attrs:{color:"white"}},[t._v("add")]),t._v("Add machine")],1)],1),t._v(" "),a("v-card",{staticClass:"profile-left-bottom",attrs:{flat:"","min-witdh":"15"}},[a("v-card-text",{staticClass:"profile-left-text"},[a("v-form",{ref:"form",staticClass:"machine-form",attrs:{"lazy-validation":""}},[a("v-text-field",{attrs:{label:"Alias","single-line":"",dense:"","prepend-inner-icon":"public",counter:20,maxlength:"20",required:""},model:{value:t.new_machine.alias,callback:function(e){t.$set(t.new_machine,"alias",e)},expression:"new_machine.alias"}}),t._v(" "),a("v-text-field",{attrs:{label:"Description","single-line":"",dense:"","prepend-inner-icon":"subject",counter:20,maxlength:"20",required:""},model:{value:t.new_machine.description,callback:function(e){t.$set(t.new_machine,"description",e)},expression:"new_machine.description"}})],1)],1),t._v(" "),a("v-card-actions",[a("v-btn",{staticClass:"profile-button",attrs:{block:""},on:{click:function(e){return t.addMachine()}}},[t._v(" ADD ")])],1)],1)],1)],1)],1)],1),t._v(" "),a("v-flex",{attrs:{"d-flex":"",fluid:""}},[a("v-layout",{attrs:{column:""}},[a("v-card",{staticClass:"profile-card-title",attrs:{flat:""}},[a("v-card-title",{staticClass:"profile-card-title-text"},[t._v("Welcome back, "+t._s(t.username)+"!")])],1),t._v(" "),a("v-card",{staticClass:"profile-card",attrs:{flat:""}},[a("v-card-title",{staticClass:"table-title"},[t._v(" Here is a list of your machines.\n\t\t\t  "),a("v-spacer"),t._v(" "),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Edit machine")])]),t._v(" "),a("v-card-text",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[a("v-text-field",{attrs:{label:"Description"},model:{value:t.editedMachine.description,callback:function(e){t.$set(t.editedMachine,"description",e)},expression:"editedMachine.description"}})],1)],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{staticClass:"login-button",attrs:{text:""},on:{click:t.close}},[t._v("Cancel")]),t._v(" "),a("v-btn",{staticClass:"login-button",attrs:{text:""},on:{click:t.save}},[t._v("Save")])],1)],1)],1),t._v(" "),[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.machines,"hide-default-footer":"",search:t.search,loading:t.loading,"item-key":"alias"},scopedSlots:t._u([{key:"item.alias",fn:function(e){var s=e.item;return[a("router-link",{attrs:{to:{path:"/machine/"+s.id}}},[t._v(" "+t._s(s.alias)+" ")])]}},{key:"item.latest",fn:function(e){var s=e.item;return[a("router-link",{attrs:{to:{path:"/runs/"+s.latest}}},[t._v(" "+t._s(s.latest)+" ")])]}},{key:"item.actions",fn:function(e){var s=e.item;return[a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.viewSecret(s)}}},[t._v(" visibility ")]),t._v(" "),a("v-icon",{attrs:{small:""},on:{click:function(e){return t.editMachine(s)}}},[t._v(" create ")])]}}])})]],2)],1)],1)],1)],1)},staticRenderFns:[]},l=a("VU/8")(n,r,!1,null,null,null);e.default=l.exports}});
//# sourceMappingURL=7.93931698b56f62ab5792.js.map